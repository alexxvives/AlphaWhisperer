You are a senior Python engineer. Build a production-ready script that monitors insider trading activity from OpenInsider and emails me when high-conviction signals occur.

Goal
Fetch recent insider Form 4 activity from openinsider.com and trigger email alerts when any of the defined signals below is detected.

Tech & Packaging
Language: Python 3.10+

Libraries: requests, pandas, beautifulsoup4 (if needed), smtplib, email, python-dotenv, tenacity (retry), schedule (or cron-friendly), logging.

Output: a single runnable script insider_alerts.py + .env.example + README.md.

No paid APIs.

Data Source
Use OpenInsider pages such as:

Latest trades: https://openinsider.com/latest-insider-trading

Filtered pages (buy/sell, role, etc.) if helpful.

Parse the main trade table reliably (HTML can shift). Implement:

Robust selector fallback (try pandas.read_html, else BeautifulSoup to locate the table by headers like “Ticker”, “Insider Name”, “Title”, “Trade Type”, “Price”, “Qty”, “Owned”, “Value”, “Date”).

Column normalization and type coercion (dates to UTC, numbers to float/int, commas removed, $ stripped).

Signals to Detect (trigger if any is true)
Use a rolling lookback window of the last 7 calendar days (configurable), and a cluster window of 5 days (configurable).

Cluster Buying: ≥ 3 insiders from the same ticker buy within the cluster window; total $ value ≥ $300,000.

CEO/CFO Buy: Any CEO or CFO buys ≥ $100,000.

Large Single Buy: Any insider buy ≥ $250,000 (after fees not required).

First Buy in 12 Months: Insider has no buys for that ticker in the last 365 days, then buys ≥ $50,000.

Buy Near 52-Week Low: Insider buy when current price ≤ 110% of 52-week low. (If OpenInsider lacks these stats, fetch price/52-week low from a free page on the same site if available; otherwise skip this signal unless easily inferable.)

Sector Cluster (optional if feasible): ≥ 5 insiders buy across 3+ tickers within the same sector over the cluster window; combined value ≥ $1,000,000.

Bearish Cluster Selling (optional): ≥ 3 insiders from the same ticker sell within cluster window and total $ value ≥ $1,000,000.

Noise Filters
Ignore trades marked as planned (Rule 10b5-1) when the form indicates it (if the text appears in the row/notes; otherwise allow).

De-duplicate by unique key: (ticker, insider_name, trade_date, trade_type, shares, price).

Exclude rows where trade type isn’t clearly “Buy” or “Sale”.

Normalize insider titles: map variants (e.g., “Chief Financial Officer”, “CFO”; “Chief Exec Officer”, “CEO”).

Config (.env)


SMTP_HOST=smtp.gmail.comSMTP_PORT=587SMTP_USER=you@example.comSMTP_PASS=app_password_hereALERT_TO=you@example.comLOOKBACK_DAYS=7CLUSTER_DAYS=5MIN_LARGE_BUY=250000MIN_CEO_CFO_BUY=100000MIN_CLUSTER_BUY_VALUE=300000MIN_FIRST_BUY_12M=50000MIN_SECTOR_CLUSTER_VALUE=1000000
Behavior
On each run:

Fetch & parse latest trades (cover at least the last 14 days to be safe).

Clean & coerce data; detect signals per rules above.

Maintain a lightweight local state file (e.g., state/seen_alerts.json) to avoid re-emailing the same alert.

For each new signal instance, send one email containing:

Subject: [Insider Alert] <TICKER> — <Signal Name>

Body (text + HTML): Ticker, Company (if available), Signal name, Reason (numbers & dates), Insider(s), Title(s), Trade dates, Qty, Price, Total value, Links to the exact OpenInsider detail page(s), and the time the alert was generated.

Log all actions to logs/insider_alerts.log.

Provide two run modes:

--once (single execution)

--loop (run every 30 minutes using schedule; interval configurable via --interval-minutes)

Email Formatting
Plain-text fallback + simple HTML table of the relevant rows for the signal.

Example subject:

[Insider Alert] ABC — CEO Buy $350,000

Example body details:

Signal: CEO/CFO Buy

Ticker: ABC

Insider: Jane Doe (CEO)

Date: 2025-11-07

Qty: 25,000 @ $14.00 — Total $350,000

Cluster Window: 5 days

Source: link to the OpenInsider trade page

CLI
python insider_alerts.py --once

python insider_alerts.py --loop --interval-minutes 30

Optional flags: --verbose, --dry-run (no emails, just logs), --since YYYY-MM-DD.

Reliability & Edge Cases
Implement retries with exponential backoff on network requests.

Gracefully handle layout changes (fallback parser), empty tables, or temporary 403.

If a field is missing, omit it but continue processing.

If price/52-week low isn’t available without a paid API, skip that specific check with a warning log (do not fail the run).

Testing
Include a small tests/fixtures/ HTML file of an OpenInsider table and a pytest-style function or simple script section that:

Parses the fixture

Confirms detection of: cluster buy, CEO/CFO buy, large single buy

Confirms de-dupe and 10b5-1 filtering.

Deliverables
insider_alerts.py (fully commented)

.env.example

README.md with:

Setup, .env config, cron examples

Signal definitions & defaults

How to extend/add rules

Troubleshooting (Gmail app passwords, rate limits)

(Optional) tests/ folder with a minimal parser test.

Now generate the codebase accordingly.